<%= content_for :title do %>
    Items Validation Report
<% end %>

<% breadcrumb :items %>

<%= render 'shared/per_pager' %>

<br><br>

<div class="well well-sm">
  <%= bootstrap_form_tag url: validation_report_items_url, method: :get, layout: :horizontal, label_col: 'col-sm-2', control_col: 'col-sm-10' do |f| %>
      <%= f.hidden_field :direction, { value: params[:direction], name: 'direction' } if params[:direction] %>
      <%= f.hidden_field :sort, { value: params[:sort], name: 'sort' } if params[:sort] %>
      <%= f.hidden_field :per_page, { value: params[:per_page], name: 'per_page' } if params[:per_page] %>
      <%= f.select :collection_id, options_for_select(@search_options[:collections].collect { |c| [c.display_title, c.id] }, selected: params[:collection_id] ), { include_blank: true }, { name: 'collection_id' } %>
      <%= f.primary 'Filter' %>
  <% end %>
</div>

<% if @items.empty? %>

    <p>No items found.</p>

<% else %>

    <table class="table table-condensed table-hover">
      <thead>
      <tr>
        <th>
          <%= sortable 'id', 'ID' %>
        </th>
        <th>
          <%= sortable 'slug' %>
        </th>
        <th>
          <%= sortable 'dc_title', 'Title' %>
        </th>
        <th>
          Valid?
        </th>
        <th>
          Errors
        </th>
        <th>
          <%= sortable 'collection_id', 'Collection' %>
        </th>
        <th width="45px"></th>
      </tr>
      </thead>

      <tbody>
      <% @items.each do |item| %>
          <tr>
            <td>
              <%= link_to item.id, item_path(item) %>
            </td>
            <td>
              <%= link_to item.slug, item_path(item) %>
            </td>
            <td>
              <%= item.title %>
            </td>
            <td>
              <%= boolean_check_icon item.errors.empty? %>
            </td>
            <td>
              <% if item.errors.any? %>
                <ul>
                <% item.errors.each do |field, message| %>
                  <li><%= field.to_s + ' ' + message %></li>
                <% end %>
                </ul>
              <% end %>
            </td>
            <td>
              <%= link_to(item.collection.display_title, collection_path(item.collection)) if item.collection %>
            </td>
            <td>
              <%= link_to 'Edit', edit_item_path(item), class: 'btn btn-default' %>
            </td>
          </tr>
      <% end %>
      </tbody>
    </table>

    <%= paginate @items %>

<% end %>
